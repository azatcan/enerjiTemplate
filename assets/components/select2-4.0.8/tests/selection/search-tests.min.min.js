module("Selection containers - Inline search");var MultipleSelection=require("select2/selection/multiple");var InlineSearch=require("select2/selection/search");var $=require("jquery");var Options=require("select2/options");var Utils=require("select2/utils");var options=new Options({});test("backspace will remove a choice",function(v){v.expect(3);var n=require("select2/keys");var l=$("#qunit-fixture .event-container");var u=new MockContainer();var p=Utils.Decorate(MultipleSelection,InlineSearch);var m=$("#qunit-fixture .multiple");var o=new p(m,options);var t=o.render();o.bind(u,l);o.on("unselect",function(){v.ok(true,"A choice was unselected")});o.update([{id:"1",text:"One"}]);var q=t.find("input");var s=t.find(".select2-selection__choice");v.equal(q.length,1,"The search was visible");v.equal(s.length,1,"The choice was rendered");var r=$.Event("keydown",{which:n.BACKSPACE});q.trigger(r)});test("backspace will set the search text",function(v){v.expect(3);var n=require("select2/keys");var l=$("#qunit-fixture .event-container");var u=new MockContainer();var p=Utils.Decorate(MultipleSelection,InlineSearch);var m=$("#qunit-fixture .multiple");var o=new p(m,options);var t=o.render();o.bind(u,l);o.update([{id:"1",text:"One"}]);var q=t.find("input");var s=t.find(".select2-selection__choice");v.equal(q.length,1,"The search was visible");v.equal(s.length,1,"The choice was rendered");var r=$.Event("keydown",{which:n.BACKSPACE});q.trigger(r);v.equal(q.val(),"One","The search text was set")});test("updating selection does not shift the focus",function(n){if(window.attachEvent&&!window.addEventListener){n.expect(0);return}var k=$("#qunit-fixture .event-container");var o=new MockContainer();var i=Utils.Decorate(MultipleSelection,InlineSearch);var p=$("#qunit-fixture .multiple");var m=new i(p,options);var j=m.render();m.bind(o,k);m.update([]);k.append(j);var l=j.find("input");l.trigger("focus");n.equal(l.length,1,"The search was not visible");n.equal(document.activeElement,l[0],"The search did not have focus originally");m.update([]);n.equal(l.length,1,"The search box disappeared");n.equal(document.activeElement,l[0],"The search did not have focus after the selection was updated")});test("the focus event shifts the focus",function(n){if(window.attachEvent&&!window.addEventListener){n.expect(0);return}var k=$("#qunit-fixture .event-container");var o=new MockContainer();var i=Utils.Decorate(MultipleSelection,InlineSearch);var p=$("#qunit-fixture .multiple");var m=new i(p,options);var j=m.render();m.bind(o,k);m.update([]);k.append(j);var l=j.find("input");n.notEqual(document.activeElement,l[0],"The search had focus originally");n.equal(l.length,1,"The search was not visible");o.trigger("focus");n.equal(l.length,1,"The search box disappeared");n.equal(document.activeElement,l[0],"The search did not have focus originally")});