module("Results - Infinite scrolling");test("loadingMore is triggered even without a scrollbar",function(a){a.expect(1);var f=require("jquery");var d=f("<select></select>");var k=f("<span></span>");var b=new MockContainer();var g=require("select2/utils");var i=require("select2/options");var c=require("select2/results");var h=require("select2/dropdown/infiniteScroll");var j=g.Decorate(c,h);var e=new j(d,new i({}));e.data={};e.data.current=function(l){l([{id:"test"}])};f("#qunit-fixture").append(e.render());e.bind(b,k);e.on("query:append",function(){a.ok(true,"It tried to load more immediately")});b.trigger("results:all",{data:{results:[{id:"test",text:"Test"}],pagination:{more:true}}})});test("loadingMore is not triggered without scrolling",function(a){a.expect(0);var f=require("jquery");var d=f("<select></select>");var l=f("<span></span>");var b=new MockContainer();var g=require("select2/utils");var i=require("select2/options");var c=require("select2/results");var h=require("select2/dropdown/infiniteScroll");var j=g.Decorate(c,h);var e=new j(d,new i({}));e.data={};e.data.current=function(m){m([{id:"test"}])};var k=e.render();f("#qunit-fixture").append(k);k.css("max-height","100px");e.bind(b,l);e.on("query:append",function(){a.ok(false,"It tried to load more immediately")});b.trigger("results:all",{data:{results:[{id:"test",text:"Test"},{id:"test",text:"Test"},{id:"test",text:"Test"},{id:"test",text:"Test"},{id:"test",text:"Test"},{id:"test",text:"Test"},{id:"test",text:"Test"}],pagination:{more:true}}})});