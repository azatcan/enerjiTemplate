define(["jquery"],function(c){function d(a,h,g){var b=g.get("tokenizer");if(b!==undefined){this.tokenizer=b}a.call(this,h,g)}d.prototype.bind=function(b,f,a){b.call(this,f,a);this.$search=f.dropdown.$search||f.selection.$search||a.find(".select2-search__field")};d.prototype.query=function(k,j,a){var l=this;function m(g){var h=l._normalizeItem(g);var e=l.$element.find("option").filter(function(){return c(this).val()===h.id});if(!e.length){var f=l.option(h);f.attr("data-select2-tag",true);l._removeOldTags();l.addOptions([f])}n(h)}function n(e){l.trigger("select",{data:e})}j.term=j.term||"";var b=this.tokenizer(j,this.options,m);if(b.term!==j.term){if(this.$search.length){this.$search.val(b.term);this.$search.trigger("focus")}j.term=b.term}k.call(this,j,a)};d.prototype.tokenizer=function(q,v,a,b){var u=a.get("tokenSeparators")||[];var w=v.term;var s=0;var r=this.createTag||function(e){return{id:e.term,text:e.term}};while(s<w.length){var i=w[s];if(c.inArray(i,u)===-1){s++;continue}var x=w.substr(0,s);var p=c.extend({},v,{term:x});var t=r(p);if(t==null){s++;continue}b(t);w=w.substr(s+1)||"";s=0}return{term:w}};return d});