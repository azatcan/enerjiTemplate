define(["jquery"],function(b){function a(e,c,d,f){this.lastParams={};e.call(this,c,d,f);this.$loadingMore=this.createLoadingMore();this.loading=false}a.prototype.append=function(d,c){this.$loadingMore.remove();this.loading=false;d.call(this,c);if(this.showLoadingMore(c)){this.$results.append(this.$loadingMore);this.loadMoreIfNeeded()}};a.prototype.bind=function(e,c,f){var d=this;e.call(this,c,f);c.on("query",function(g){d.lastParams=g;d.loading=true});c.on("query:append",function(g){d.lastParams=g;d.loading=true});this.$results.on("scroll",this.loadMoreIfNeeded.bind(this))};a.prototype.loadMoreIfNeeded=function(){var e=b.contains(document.documentElement,this.$loadingMore[0]);if(this.loading||!e){return}var d=this.$results.offset().top+this.$results.outerHeight(false);var c=this.$loadingMore.offset().top+this.$loadingMore.outerHeight(false);if(d+50>=c){this.loadMore()}};a.prototype.loadMore=function(){this.loading=true;var c=b.extend({},{page:1},this.lastParams);c.page++;this.trigger("query:append",c)};a.prototype.showLoadingMore=function(c,d){return d.pagination&&d.pagination.more};a.prototype.createLoadingMore=function(){var d=b('<li class="select2-results__option select2-results__option--load-more"role="treeitem" aria-disabled="true"></li>');var c=this.options.get("translations").get("loadingMore");d.html(c(this.lastParams));return d};return a});